=========================
Работа с прокси-серверами
=========================

Настройка прокси-сервера
------------------------

Для использования проки-сервера вам нужно задать две опции: :ref:`option_proxy` и :ref:`option_proxy_type`. Опция :ref:`option_proxy` принимает значения в виде строки `server:port`. Опция :ref:`option_proxy_type` допускает значения трёх типов: `http`, `socks4` и `socks5`. Пример::

    g.setup(proxy='gate.somhost.com:444', proxy_type='http')
    
Если прокси-сервер требует авторизации, используйте опцию :ref:`option_proxy_userpwd`, которая принимает значение в виде строки `username:password`.

Обратите внимание, что в случае использования прокси-сервера, информация о нём будет отображаться в logging-сообщениях, соответствующих конкретному запросу.

Работа со списками прокси
-------------------------

Grab поддерживает работу со списком-прокси. Используйте метод :meth:`~grab.base.BaseGrab.load_proxylist` для задания списка проксей::

    g.setup_proxylist(proxy_file='/path/to/file.txt', proxy_type='http')

Следующими аргументами метода :meth:`~grab.base.BaseGrab.load_proxylist` вы можете настроить работу со списком проксей:

:source: источник - путь к файлу или объект, содержащий список прокси серверов
:source_type: тип источника. По-умолчанию, "text_file" т.е. текстовый файл.
:proxy_type: тип прокси-серверов. Возможные варианты: "http", "socks4", "socks5". По-умолчанию, "http".
:auto_init: При загрузке прокси-листа автоматически выставляется случайный прокси-сервер.
:auto_change: При загрузке прокси-листа автоматически выставляется случайный прокси-сервер и далее меняется при каждом новом запросе.

Строки в файле, указываемом в `source` аргументе, могут быть в двух форматах:

* Простой формат: "server:port"
* Сложный формат: "server:port:username:password". Используйте его, если прокси-сервер требует авторизации.

Для того, чтобы вручную сменить прокси-сервер, вы можете вызывтаь функцию `change_proxy`, которая выберет случайный прокси из прокси-листа.
